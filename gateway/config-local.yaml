# Gateway Configuration for Local Development
server:
  http:
    host: "0.0.0.0"
    port: "8001"
    read_timeout: "30s"
    write_timeout: "30s"
    idle_timeout: "60s"
    bounds:
      max_batch: 1000
      max_message_bytes: 65536
    pipeline:
      enqueue_timeout: "5s"

otlp:
  max_log_size: 1048576      # 1MB
  max_message_bytes: 1048576 # 1MB max message size
  max_batch_size: 1000       # 1000 logs per batch
  max_labels: 100            # 100 labels per log
  max_fields: 200            # 200 fields per log
  request_timeout: "30s"     # 30s timeout
  validate_utf8: true        # Validate UTF-8
  allowed_schemas: ["JSON", "LOGFMT", "TEXT"]

emitter:
  output_type: "stdout"      # stdout, kafka, grpc
  batch_size: 100            # Batch size for output
  flush_interval: 5          # Flush interval in seconds

miner:
  addr: "localhost:50051"  # Override the endpoint
  timeout: "500ms"              # Override timeout
  max_batch: 1000               # Override batch size
  max_batch_wait: "50ms"        # Override batch wait time
  max_retries: 3                # Override retry count
  retry_base_delay: "50ms"      # Override retry delay
  shadow_only: false            # Enable actual log dropping

sampler:
  addr: "localhost:50060"       # Local gRPC endpoint (different port from miner/indexfeed)
  timeout: "500ms"              # Longer timeout for local development
  max_batch: 1000               # Max batch size
  max_batch_wait: "50ms"        # Longer wait time for local development

enforcement:
  debug: true                   # Enforce debug logs
  info: false                   # Enforce info logs
  warn: false                   # Enforce warn logs
  error: false                  # Enforce error logs
  by_namespace:                 # Per-namespace overrides
    staging: true

# Loki sink configuration - MOCK MODE for local development
loki:
  addr: "http://loki:3100"
  flush_interval: "400ms"
  max_batch_bytes: 1000000      # 1MB
  max_batch_entries: 5000
  max_buffer_bytes: 268435456   # 256MB
  max_buffer_entries: 1000000
  request_timeout: "5s"
  mock_mode: true               # ENABLED for local development (outputs to stdout)
  retry:
    enabled: true
    initial_backoff: "200ms"
    max_backoff: "5s"
  drop_policy:
    debug_first: true
    protect_info: true
  labels:
    static:
      gateway: "true"

# IndexFeed service configuration - LOCAL DEVELOPMENT
indexfeed:
  addr: "localhost:50070"        # Local gRPC endpoint (different port from miner)
  timeout: "500ms"               # Longer timeout for local development
  max_retries: 3                 # More retries for local development
  retry_base_delay: "50ms"       # Longer delay for local development

metrics: {}
